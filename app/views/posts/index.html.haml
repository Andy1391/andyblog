%p.notice #{notice}
%h1 Posts
%table
  %thead
    %tr
      %th Title
      %th Text
      %th Author
      %th Post Date
      %th Comment
      %th{:colspan => "3"}
  %tbody
    - @posts.each do |post|    
      %tr
        %td= post.title
        %td.post_wrap= post.text
        %td= post.user.name
        %td= post.created_at.strftime("%Y-%m-%d  %H:%M:%S")
        %td
          = link_to 'Show', post , :class => "btn btn-success"
          - if can? :update, post
            = link_to 'Edit', edit_post_path(post), :class => "btn btn-secondary"
          - if can? :delete, post
            = link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } , :class => "btn btn-danger"
          = link_to 'New Comment',  new_post_comment_path( :post_id => post.id ) , :class => "btn btn-primary"
      

      - post.comments.each do |comment, index|
        %tr
          %th= "User #{comment.name} write "
          %td= comment.comment_text
          %td= link_to 'Edit', edit_post_comment_path(:id => comment.id ,:post_id => post.id )
          %td= link_to 'Destroy', post_comment_path(post, comment), method: :delete , data: { confirm: 'Are you sure?' }
= link_to 'New Post', new_post_path  , :class => "btn btn-outline-primary"
